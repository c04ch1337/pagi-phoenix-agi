# Phoenix AGI (pagi) Environment Variables
# Copy to .env and customize. Defaults align with bare-metal blueprint.
# Blueprint complete — ready for template use and vertical adaptations.
# Load via shell: source .env
# Sections: General, Rust Core, Python Bridge, Memory/External Services, Self-Evolution

# General: System-wide configs
PAGI_LOG_LEVEL=info  # Log level: trace/debug/info/warn/error
PAGI_PROJECT_ROOT=./  # Root path; relative to cwd
PAGI_FRONTEND_PORT=3000  # Frontend dev server port (e.g. for pagi-frontend)

# Rust Core-Orchestrator: Ports, paths, safety
PAGI_GRPC_PORT=50051  # gRPC listen port for Rust Pagi service
PAGI_MAX_RECURSION_DEPTH=5  # SafetyGovernor depth cap; aligns with Python
PAGI_HITL_GATE=true  # Enable HITL for core patches (true/false)

# Python Intelligence-Bridge: API, models, skills
PAGI_HTTP_PORT=8000  # FastAPI listen port
PAGI_OPENROUTER_MODEL=openrouter/auto  # LiteLLM model; e.g., 'gpt-4o' or 'claude-3.5-sonnet'
PAGI_OPENROUTER_API_KEY=your_openrouter_key_here  # Required for LiteLLM outbound calls
PAGI_SKILLS_DIR=src/skills  # Relative to bridge root; for L5 procedural
PAGI_PEEK_MAX_CHARS=2000  # Limit for file peeking to prevent overflow
PAGI_ALLOW_LOCAL_DISPATCH=false  # Allow in-process execution of allow-listed L5 skills for local testing
# When true, allow-list = peek_file, save_skill, execute_skill, list_dir, read_entire_file_safe, write_file_safe, list_files_recursive, analyze_code, search_codebase, run_tests, run_python_code_safe (execute_skill enables chaining; search_codebase for pattern search; run_tests for pytest/cargo; run_python_code_safe for sandboxed Python snippet execution).
PAGI_ALLOW_REAL_DISPATCH=false  # Enables real subprocess execution in Rust — use only in trusted environments. When true, orchestrator runs allow-listed skills via python (no shell; timeout enforced). Requires PAGI_ACTIONS_VIA_GRPC=true on bridge.
PAGI_AGENT_ACTIONS_LOG=  # If set, orchestrator and bridge append ACTION lines here (fallback: PAGI_SELF_HEAL_LOG)
PAGI_VERBOSE_ACTIONS=true  # Print action execution lines to stdout (disable for max throughput)
PAGI_DISABLE_SKILL_IMPORT_CACHE=false  # Disable local skill import caching by mtime (set true during rapid skill iteration)
PAGI_MULTI_TURN_CONTEXT_MAX_TOKENS=  # Optional cap for context accumulation in multi-turn RLM (character-based stub); e.g. 10000
PAGI_MULTI_TURN_CONTEXT_MAX_CHARS=10000  # Cap for chained context in multi-turn RLM (chars)
PAGI_VERTICAL_USE_CASE=research  # Configures RLM: research (self-patch), codegen (AI codegen → codegen_output), code_review (analyze → run_tests → write to reviewed/)
PAGI_CODEGEN_OUTPUT_DIR=codegen_output  # Output dir for codegen vertical (under PAGI_PROJECT_ROOT); used when PAGI_VERTICAL_USE_CASE=codegen

# Memory/External Services: Qdrant, SurrealDB stubs
PAGI_QDRANT_URI=http://localhost:6334  # Local Qdrant for L4 semantic; cluster URI for scale
PAGI_QDRANT_API_KEY=  # Optional auth for non-local
PAGI_EMBEDDING_DIM=1536  # Vector size cap; matches Sentence Transformers default
PAGI_SURREALDB_PATH=db/surreal.db  # L3-L7 disk storage; relative to core
PAGI_OPENROUTER_GATEWAY=http://localhost:3000  # If using local proxy; else direct

# Self-Evolution: Watchdog, Git, Healing
PAGI_REGISTRY_PATH=../pagi-skills  # Evolution Registry dir; relative to core
PAGI_CORE_DIR=.  # Rust core dir for 'cargo test'
PAGI_BRIDGE_DIR=../pagi-intelligence-bridge  # Python bridge dir for 'poetry run pytest'
PAGI_WATCH_INTERVAL_SECS=60  # Git-Watcher poll interval
PAGI_SELF_HEAL_LOG=agent_actions.log  # If set, Python appends heal reports here
PAGI_ALLOW_SELF_HEAL_GRPC=false  # Enable gRPC self-heal from bridge to orchestrator (true/false); when true, bridge errors trigger ProposePatch/ApplyPatch via gRPC
PAGI_APPROVE_FLAG=approve.patch  # HITL flag file; presence in core dir enables apply for core patches (polled in SimulateError/real heal)
PAGI_HITL_POLL_SECS=30  # Max seconds to poll for PAGI_APPROVE_FLAG before apply when HITL required (SimulateError / real heal)
PAGI_PATCH_DIR=patches  # Subdir in registry for temp patch files (.rs/.py)
PAGI_SELF_PATCH_DIR=patches  # Configurable path for vertical self-patch output (RLM write_file_safe; under PAGI_PROJECT_ROOT)
PAGI_AUTO_COMMIT_SELF_PATCH=true  # Enable Git commit after apply (true/false); when true, successful apply auto-commits to registry
PAGI_AUTO_EVOLVE_SKILLS=true  # Enable auto-evolve after patch (true/false). When true, successful python_skill apply triggers evolve_skill_from_patch and Git commit in bridge repo (auto-evolved skill)
